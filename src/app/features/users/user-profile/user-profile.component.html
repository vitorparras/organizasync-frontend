<div class="profile-container">
  <div class="profile-header">
    <h1>Meu Perfil</h1>
  </div>

  <div class="profile-content">
    <div class="profile-card">
      <h2>Informações Pessoais</h2>

      @if (userService.loading()) {
        <div class="loading-container">
          <div class="loading-spinner"></div>
          <p>Carregando...</p>
        </div>
      } @else {
        <form [formGroup]="profileForm" (ngSubmit)="onUpdateProfile()" class="profile-form">
          <div class="form-group">
            <app-input
              formControlName="name"
              label="Nome"
              type="text"
              placeholder="Digite seu nome completo"
              [required]="true"
              [invalid]="isProfileFieldInvalid('name')"
              [errorMessage]="getProfileFieldErrorMessage('name')"
            ></app-input>
          </div>

          <div class="form-group">
            <app-input
              formControlName="email"
              label="E-mail"
              type="email"
              placeholder="Digite seu e-mail"
              [required]="true"
              [invalid]="isProfileFieldInvalid('email')"
              [errorMessage]="getProfileFieldErrorMessage('email')"
            ></app-input>
          </div>

          <div class="form-actions">
            <app-button
              type="submit"
              [loading]="userService.loading()"
              [disabled]="profileForm.invalid || !profileForm.dirty"
            >
              Atualizar Perfil
            </app-button>
          </div>
        </form>
      }
    </div>

    <div class="profile-card">
      <h2>Alterar Senha</h2>

      <form [formGroup]="passwordForm" (ngSubmit)="onChangePassword()" class="profile-form">
        <div class="form-group">
          <app-input
            formControlName="currentPassword"
            label="Senha Atual"
            type="password"
            placeholder="Digite sua senha atual"
            [required]="true"
            [invalid]="isPasswordFieldInvalid('currentPassword')"
            [errorMessage]="getPasswordFieldErrorMessage('currentPassword')"
          ></app-input>
        </div>

        <div class="form-group">
          <app-input
            formControlName="newPassword"
            label="Nova Senha"
            type="password"
            placeholder="Digite sua nova senha"
            [required]="true"
            [invalid]="isPasswordFieldInvalid('newPassword')"
            [errorMessage]="getPasswordFieldErrorMessage('newPassword')"
          ></app-input>
        </div>

        <div class="form-group">
          <app-input
            formControlName="confirmPassword"
            label="Confirmar Nova Senha"
            type="password"
            placeholder="Confirme sua nova senha"
            [required]="true"
            [invalid]="isPasswordFieldInvalid('confirmPassword')"
            [errorMessage]="getPasswordFieldErrorMessage('confirmPassword')"
          ></app-input>
        </div>

        <div class="form-actions">
          <app-button
            type="submit"
            [loading]="userService.loading()"
            [disabled]="passwordForm.invalid"
          >
            Alterar Senha
          </app-button>
        </div>
      </form>
    </div>
  </div>
</div>
